#!/bin/bash

# ------------------------------------------------------------------------------
# Globals
# ------------------------------------------------------------------------------

function ConfigureGlobals() {
  . /etc/os-release                                         # Set linux distribution (debian | arch) into ID global
  export LINUX="$ID"                                        # Linux distribution

  if [[ $LINUX != "arch" ]]; then
    echo "This installation does not work for the" $LINUX "distribution!"
    exit 1                                                  # Exit on wrong option
  fi
}

function UpdatePackages() { 
  pacman-key --init
  pacman-key --populate
  pacman -Syu --noconfirm
}

function Install() {
  packages=$1                                               # First argument: packages to be installed
  pacman -S $packages --noconfirm
}

function EnableService() {
  service=$1
  systemctl enable $service
}

function CopySetupScript() {
  mkdir -p /mnt/root/.install
  cp -r ~/linux /mnt/root/.install
}

# ------------------------------------------------------------------------------
# Partition
# ------------------------------------------------------------------------------

function CreatePartitions() {
  echo -e "o\nn\n\n\n\n\na\nw\n" | fdisk /dev/sda
}

function FormatPartitions() {
  mkfs.ext4 /dev/sda1
}

function MountPartitions() {
  mkdir -p /mnt
  mount /dev/sda1 /mnt
}

function UmountPartitions() {
  umount -R /mnt
}

function ShutdownSystem() {
  shutdown -h now
}
